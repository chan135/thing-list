// @flow
import React from 'react';

export type PageComponent = any[];
export type PageBuilderProps = {
  data: PageComponent[]
};

export default function PageBuilder({ data }: PageBuilderProps) {
  if (!data.length) {
    return null;
  } else if (data.length === 1) {
    return renderComponent(data[0]);
  }

  return (
    <div>
      {data.map(renderRootComponent)}
    </div>
  );
}

function renderRootComponent(data: PageComponent, key: number) {
  const props = {
    ...data[1],
    key,
  };
  const newData: PageComponent = [data[0], props, ...data.slice(2)];

  return renderComponent(newData);
}

function renderComponent(data: PageComponent) {
  const component = getComponent(data[0]);
  const props = data[1];
  const children = data.slice(2);

  return React.createElement(component, props, ...children);
}

function getComponent(name: string): string | ReactClass<*> {
  return name;
}
